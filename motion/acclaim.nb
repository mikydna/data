(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33229,        700]
NotebookOptionsPosition[     32705,        677]
NotebookOutlinePosition[     33059,        693]
CellTagsIndexPosition[     33016,        690]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"research", ".", "cs", ".", "wisc", ".", "edu"}], "/", 
        "graphics"}], "/", "Courses"}], "/", "cs"}], "-", "838", "-", 
     RowBox[{
      RowBox[{"1999", "/", "Jeff"}], "/", "ASF"}], "-", 
     RowBox[{"AMC", ".", "html"}]}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.68234754110985*^9, 3.682347543537168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"raw$afs", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</Users/andy/Code/data/motion/cmu/dance/94.asf\>\"", ",", " ", 
     "\"\<String\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682343444834629*^9, 3.682343476065287*^9}, {
  3.682354237662434*^9, 3.68235424556879*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ParseAFS", "[", "afs_", "]"}], ":=", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"splits", "=", 
         RowBox[{"Association", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "->", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}], "&"}], "@", 
             RowBox[{"(", 
              RowBox[{"StringTrim", "/@", 
               RowBox[{"StringSplit", "[", 
                RowBox[{"#", ",", "\"\<\\n\>\""}], "]"}]}], ")"}]}], "&"}], 
           "\[IndentingNewLine]", "/@", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"afs", ",", "\"\<:\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"4", ";;"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "root", ",", 
        "\[IndentingNewLine]", "hierarchy", ",", "\[IndentingNewLine]", 
        "bones", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "pos"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"root", "=", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"kv", "=", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ToExpression", "/@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{"StringSplit", "/@", 
                RowBox[{"splits", "[", "\"\<root\>\"", "]"}]}], ")"}]}], 
             "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", "kv"}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"hierarchy", "=", 
        RowBox[{"Block", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"paths", "=", 
             RowBox[{
              RowBox[{"splits", "[", "\"\<hierarchy\>\"", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "v", ",", "\[IndentingNewLine]", "graph"}],
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", "=", 
            RowBox[{"DeleteDuplicates", "[", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{"StringTrim", "/@", 
               RowBox[{"(", 
                RowBox[{"StringSplit", "/@", "paths"}], ")"}]}], "]"}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"graph", "=", 
            RowBox[{"Graph", "[", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
              RowBox[{"Map", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Block", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"path", "=", 
                    RowBox[{"StringTrim", "/@", 
                    RowBox[{"StringSplit", "[", "#", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", "from", ",", "to"}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                   
                   RowBox[{
                    RowBox[{"from", "=", 
                    RowBox[{"path", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"to", "=", 
                    RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"from", "\[Rule]", "#"}], "&"}], "/@", "to"}]}]}],
                   "\[IndentingNewLine]", "]"}], "&"}], ",", 
                "\[IndentingNewLine]", "paths"}], "\[IndentingNewLine]", 
               "]"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[GreaterEqual]", 
                   "1"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"{", "\"\<root\>\"", "}"}]}], "]"}]}], "}"}], "&"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"FindPath", "[", 
                  RowBox[{"graph", ",", "\"\<root\>\"", ",", "#"}], "]"}]}], 
                "}"}], "&"}], "/@", "v"}]}], "\[IndentingNewLine]", "]"}]}]}],
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"bones", "=", 
        RowBox[{"Block", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"data", "=", 
            RowBox[{"splits", "[", "\"\<bonedata\>\"", "]"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Block", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"begins", " ", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"data", ",", "\"\<begin\>\""}], "]"}], "//", 
                "Flatten"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ends", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"data", ",", "\"\<end\>\""}], "]"}], "//", 
                "Flatten"}]}], ",", "\[IndentingNewLine]", "pos", ",", 
              "\[IndentingNewLine]", "parsed"}], "\[IndentingNewLine]", "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pos", "=", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"Riffle", "[", 
                 RowBox[{"begins", ",", "ends"}], "]"}], ",", "2"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"parsed", "=", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Association", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "&"}], "@", 
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", " ", "Whitespace"}], "]"}]}], ")"}], 
                   "&"}], "/@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ";;", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@",
                  "pos"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Association", "[", "\[IndentingNewLine]", 
              RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<name\>\"", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"Association", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<id\>\"", "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<id\>\"", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<name\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<name\>\"", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<direction\>\"", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Internal`StringToDouble", "[", "#", "]"}], "&"}],
                     "/@", 
                    RowBox[{"#", "[", "\"\<direction\>\"", "]"}]}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<length\>\"", "\[Rule]", " ", 
                    RowBox[{"Internal`StringToDouble", "[", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<length\>\"", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"\"\<$$offset\>\"", "\[Rule]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Internal`StringToDouble", "[", "#", "]"}], "&"}],
                     "/@", 
                    RowBox[{"#", "[", "\"\<direction\>\"", "]"}]}], ")"}], 
                    "*", 
                    RowBox[{"Internal`StringToDouble", "[", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<length\>\"", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}]}], 
                    "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                    "]"}]}], "&"}], ",", "\[IndentingNewLine]", "parsed"}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<root\>\"", "\[Rule]", 
                 RowBox[{"<|", 
                  RowBox[{"\"\<$$offset\>\"", "\[Rule]", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "|>"}]}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}],
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", "\[IndentingNewLine]", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Block", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"name", "=", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"path", "=", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"name", "\[Rule]", 
               RowBox[{"Total", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"bones", "[", "#", "]"}], "[", "\"\<$$offset\>\"",
                     "]"}], "&"}], ",", "path"}], "]"}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
           "hierarchy"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]",
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"hierarchy", ",", "pos"}], "}"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hierarchy", ",", "pos"}], "}"}], "=", 
     RowBox[{"ParseAFS", "[", "raw$afs", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PointSize", "[", "Large", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Point", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Normal", "[", "pos", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"(", 
          RowBox[{"pos", "/@", "#"}], ")"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"hierarchy", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6823542311629972`*^9, 3.682354633336156*^9}, {
  3.682354664928864*^9, 3.682354676784075*^9}, {3.682354729606333*^9, 
  3.6823551575194674`*^9}, {3.682355199425824*^9, 3.682355381745359*^9}, {
  3.682355416517806*^9, 3.682355448056218*^9}, {3.682355543035239*^9, 
  3.682355692362878*^9}, {3.682355728557693*^9, 3.682355856961526*^9}, {
  3.682355890763763*^9, 3.682356038932455*^9}, {3.68235607057084*^9, 
  3.682356406508017*^9}, {3.682356438740738*^9, 3.682356461632214*^9}, {
  3.682356493452663*^9, 3.682356744298324*^9}, {3.682356777990625*^9, 
  3.6823569112465887`*^9}, {3.682356953654543*^9, 3.68235702096*^9}, {
  3.6823570750814543`*^9, 3.682357361566188*^9}, {3.6823574390830584`*^9, 
  3.682357439321926*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {PointSize[Large], 
   Point3DBox[{{0, 0, 0}, {1.2836631626, -1.5847179901, 
     0.8754403622999999}, {-1.2179465779999998`, -1.584718958, 0.87544022}, {
     0.011796664935000001`, 1.7643047565, -0.06386537355}, {
     3.4695300835999996`, -7.59034293775, 0.8754403622999999}, {
     5.860376431, -14.15914469416, 0.8754403622999999}, {
     5.980409706292, -14.488932599710001`, 2.9064519729700002`}, {
     5.980409706307981, -14.488932599753905`, 
     3.9471919729700002`}, {-3.4450850524, -7.703736659960001, 
     0.87544022}, {-5.8481415138, -14.30608545647, 
     0.87544022}, {-6.003336310104, -14.73248082605, 
     2.78973679892}, {-6.003336310119216, -14.732480826091791`, 
     3.78056179892}, {0.007912114291800002, 3.5108185677000003`, 
     0.031490876754}, {-0.004984857134699998, 5.2635686641, 
     0.15509636349900002`}, {0.0361282342483, 6.725310489150001, 
     0.299062052834}, {2.7041830334253, 6.6122678833, 
     0.000923509754999996}, {-3.0681437299847, 6.40082346484, 
     0.046266615250000004`}, {0.041148812384899994`, 
     8.17111478883, -0.018048750006000064`}, {0.0372025465289, 
     9.66362744163, -0.14131560696600004`}, {7.170283033425299, 
     6.61226788309949, 0.0009235097549999856}, {10.5844230334253, 
     6.612267882946208, 0.0009235097550000237}, {12.2914930334253, 
     6.612267882869563, 0.0009235097550000237}, {12.619791033425301`, 
     6.612267882854824, 0.0009235097549999853}, {12.560216320849301`, 
     6.612267882845436, 0.269646797179}, {12.884473033425301`, 
     6.612267882842943, 0.0009235097549999853}, {-7.4724537299847, 
     6.400823464642264, 0.04626661525000001}, {-10.5193337299847, 
     6.400823464505473, 0.046266615250000045`}, {-12.042773729984699`, 
     6.400823464437069, 0.046266615250000045`}, {-12.543262729984699`, 
     6.400823464414605, 0.04626661525000001}, {-12.452441827290698`, 
     6.40082346440029, 0.45593471255600004`}, {-12.946769729984698`, 
     6.400823464396489, 0.04626661525000001}}], {
    Line3DBox[{{0, 0, 0}, {1.2836631626, -1.5847179901, 0.8754403622999999}}],
     Line3DBox[{{0, 0, 0}, {-1.2179465779999998`, -1.584718958, 0.87544022}}],
     Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}}], 
    Line3DBox[{{0, 0, 0}, {1.2836631626, -1.5847179901, 0.8754403622999999}, {
      3.4695300835999996`, -7.59034293775, 0.8754403622999999}}], 
    Line3DBox[{{0, 0, 0}, {1.2836631626, -1.5847179901, 0.8754403622999999}, {
      3.4695300835999996`, -7.59034293775, 0.8754403622999999}, {
      5.860376431, -14.15914469416, 0.8754403622999999}}], 
    Line3DBox[{{0, 0, 0}, {1.2836631626, -1.5847179901, 0.8754403622999999}, {
      3.4695300835999996`, -7.59034293775, 0.8754403622999999}, {
      5.860376431, -14.15914469416, 0.8754403622999999}, {
      5.980409706292, -14.488932599710001`, 2.9064519729700002`}}], 
    Line3DBox[{{0, 0, 0}, {1.2836631626, -1.5847179901, 0.8754403622999999}, {
      3.4695300835999996`, -7.59034293775, 0.8754403622999999}, {
      5.860376431, -14.15914469416, 0.8754403622999999}, {
      5.980409706292, -14.488932599710001`, 2.9064519729700002`}, {
      5.980409706307981, -14.488932599753905`, 3.9471919729700002`}}], 
    Line3DBox[{{0, 0, 0}, {-1.2179465779999998`, -1.584718958, 
      0.87544022}, {-3.4450850524, -7.703736659960001, 0.87544022}}], 
    Line3DBox[{{0, 0, 0}, {-1.2179465779999998`, -1.584718958, 
      0.87544022}, {-3.4450850524, -7.703736659960001, 
      0.87544022}, {-5.8481415138, -14.30608545647, 0.87544022}}], 
    Line3DBox[{{0, 0, 0}, {-1.2179465779999998`, -1.584718958, 
      0.87544022}, {-3.4450850524, -7.703736659960001, 
      0.87544022}, {-5.8481415138, -14.30608545647, 
      0.87544022}, {-6.003336310104, -14.73248082605, 2.78973679892}}], 
    Line3DBox[{{0, 0, 0}, {-1.2179465779999998`, -1.584718958, 
      0.87544022}, {-3.4450850524, -7.703736659960001, 
      0.87544022}, {-5.8481415138, -14.30608545647, 
      0.87544022}, {-6.003336310104, -14.73248082605, 
      2.78973679892}, {-6.003336310119216, -14.732480826091791`, 
      3.78056179892}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {0.0361282342483, 
      6.725310489150001, 0.299062052834}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {2.7041830334253, 6.6122678833, 
      0.000923509754999996}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {-3.0681437299847, 6.40082346484, 
      0.046266615250000004`}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {0.0361282342483, 
      6.725310489150001, 0.299062052834}, {0.041148812384899994`, 
      8.17111478883, -0.018048750006000064`}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {0.0361282342483, 
      6.725310489150001, 0.299062052834}, {0.041148812384899994`, 
      8.17111478883, -0.018048750006000064`}, {0.0372025465289, 
      9.66362744163, -0.14131560696600004`}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {2.7041830334253, 6.6122678833, 
      0.000923509754999996}, {7.170283033425299, 6.61226788309949, 
      0.0009235097549999856}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {2.7041830334253, 6.6122678833, 
      0.000923509754999996}, {7.170283033425299, 6.61226788309949, 
      0.0009235097549999856}, {10.5844230334253, 6.612267882946208, 
      0.0009235097550000237}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {2.7041830334253, 6.6122678833, 
      0.000923509754999996}, {7.170283033425299, 6.61226788309949, 
      0.0009235097549999856}, {10.5844230334253, 6.612267882946208, 
      0.0009235097550000237}, {12.2914930334253, 6.612267882869563, 
      0.0009235097550000237}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {2.7041830334253, 6.6122678833, 
      0.000923509754999996}, {7.170283033425299, 6.61226788309949, 
      0.0009235097549999856}, {10.5844230334253, 6.612267882946208, 
      0.0009235097550000237}, {12.2914930334253, 6.612267882869563, 
      0.0009235097550000237}, {12.619791033425301`, 6.612267882854824, 
      0.0009235097549999853}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {2.7041830334253, 6.6122678833, 
      0.000923509754999996}, {7.170283033425299, 6.61226788309949, 
      0.0009235097549999856}, {10.5844230334253, 6.612267882946208, 
      0.0009235097550000237}, {12.2914930334253, 6.612267882869563, 
      0.0009235097550000237}, {12.560216320849301`, 6.612267882845436, 
      0.269646797179}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {2.7041830334253, 6.6122678833, 
      0.000923509754999996}, {7.170283033425299, 6.61226788309949, 
      0.0009235097549999856}, {10.5844230334253, 6.612267882946208, 
      0.0009235097550000237}, {12.2914930334253, 6.612267882869563, 
      0.0009235097550000237}, {12.619791033425301`, 6.612267882854824, 
      0.0009235097549999853}, {12.884473033425301`, 6.612267882842943, 
      0.0009235097549999853}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {-3.0681437299847, 6.40082346484, 
      0.046266615250000004`}, {-7.4724537299847, 6.400823464642264, 
      0.04626661525000001}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {-3.0681437299847, 6.40082346484, 
      0.046266615250000004`}, {-7.4724537299847, 6.400823464642264, 
      0.04626661525000001}, {-10.5193337299847, 6.400823464505473, 
      0.046266615250000045`}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {-3.0681437299847, 6.40082346484, 
      0.046266615250000004`}, {-7.4724537299847, 6.400823464642264, 
      0.04626661525000001}, {-10.5193337299847, 6.400823464505473, 
      0.046266615250000045`}, {-12.042773729984699`, 6.400823464437069, 
      0.046266615250000045`}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {-3.0681437299847, 6.40082346484, 
      0.046266615250000004`}, {-7.4724537299847, 6.400823464642264, 
      0.04626661525000001}, {-10.5193337299847, 6.400823464505473, 
      0.046266615250000045`}, {-12.042773729984699`, 6.400823464437069, 
      0.046266615250000045`}, {-12.543262729984699`, 6.400823464414605, 
      0.04626661525000001}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {-3.0681437299847, 6.40082346484, 
      0.046266615250000004`}, {-7.4724537299847, 6.400823464642264, 
      0.04626661525000001}, {-10.5193337299847, 6.400823464505473, 
      0.046266615250000045`}, {-12.042773729984699`, 6.400823464437069, 
      0.046266615250000045`}, {-12.452441827290698`, 6.40082346440029, 
      0.45593471255600004`}}], 
    Line3DBox[{{0, 0, 0}, {0.011796664935000001`, 
      1.7643047565, -0.06386537355}, {0.007912114291800002, 
      3.5108185677000003`, 0.031490876754}, {-0.004984857134699998, 
      5.2635686641, 0.15509636349900002`}, {-3.0681437299847, 6.40082346484, 
      0.046266615250000004`}, {-7.4724537299847, 6.400823464642264, 
      0.04626661525000001}, {-10.5193337299847, 6.400823464505473, 
      0.046266615250000045`}, {-12.042773729984699`, 6.400823464437069, 
      0.046266615250000045`}, {-12.543262729984699`, 6.400823464414605, 
      0.04626661525000001}, {-12.946769729984698`, 6.400823464396489, 
      0.04626661525000001}}]}},
  ImageSize->{370.42765522039343`, 368.09202298024223`},
  ViewPoint->{1.3870957617378201`, 0.6958783616586942, 3.0069450699246545`},
  ViewVertical->{0.4535095144381479, 0.903103913275143, 
   1.6334344844987834`}]], "Output",
 CellChangeTimes->{
  3.68235577948482*^9, 3.6823559063971043`*^9, {3.682355941550872*^9, 
   3.682355993523587*^9}, {3.6823560245769787`*^9, 3.682356039297181*^9}, {
   3.6823560778673058`*^9, 3.682356139024551*^9}, {3.682356181648061*^9, 
   3.6823562369236813`*^9}, 3.682356268176544*^9, 3.682356407719146*^9, {
   3.682356444605641*^9, 3.68235646337076*^9}, {3.682356512398858*^9, 
   3.682356527198061*^9}, {3.6823566013863783`*^9, 3.682356638464333*^9}, {
   3.6823566703820343`*^9, 3.682356712459469*^9}, 3.6823567447217197`*^9, {
   3.682356835865555*^9, 3.682356911674664*^9}, 3.682356966031816*^9, 
   3.6823570213216553`*^9, {3.682357086758471*^9, 3.68235712085544*^9}, {
   3.6823571786619253`*^9, 3.6823572042809153`*^9}, {3.682357249815134*^9, 
   3.682357362065386*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{
      RowBox[{"Dot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"axis", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"s", "\[IndentingNewLine]", 
         RowBox[{"RotationMatrix", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"axis", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"axis", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "//", "MatrixForm"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"offset", "=", 
     RowBox[{"dir", "*", "len"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",\

 CellChangeTimes->{{3.682354317994381*^9, 3.682354321964012*^9}, 
   3.682354555881607*^9, {3.682357418738758*^9, 3.682357434887857*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"order\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"TX", ",", "TY", ",", "TZ", ",", "RX", ",", "RY", ",", "RZ"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"axis\"\>", "\[Rule]", 
    RowBox[{"{", "XYZ", "}"}]}], ",", 
   RowBox[{"\<\"position\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"orientation\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.6823543222659283`*^9, {3.682354413030591*^9, 3.682354433346345*^9}, {
   3.682354480429337*^9, 3.6823545534794397`*^9}}]
}, Open  ]]
},
WindowSize->{1280, 751},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 23, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 508, 15, 46, "Input"],
Cell[1069, 37, 327, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[1421, 49, 15822, 345, 2171, "Input"],
Cell[17246, 396, 13311, 215, 383, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30594, 616, 1388, 38, 148, "Input"],
Cell[31985, 656, 704, 18, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
